<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Weighted latin square problem &mdash; toulbar2 1.0.0 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/toulbar2.css" type="text/css" />
      <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> toulbar2
          </a>
              <div class="version">
                1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../presentation.html">Presentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../downloads.html">Downloads</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks.html">Benchmark libraries</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="usecases.html">Use cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userdoc.html">User Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../refman.html">Reference Manual</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pdfmanuals.html">Documentation in pdf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../publications.html">Publications</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">toulbar2</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          
<div class=toulbar2header>

  <div class="toulbar2logo">

    <h1>toulbar2</h1>
    <h2>An exact solver for cost function networks</h2>

  </div>

  <div class=toulbar2headerline>

    <a href=../presentation.html>Presentation</a> |
    <a href=../downloads.html>Downloads</a> |
    <a href=../benchmarks.html>Benchmarks</a> |
    <a href=tutorials.html>Tutorials</a> |
    <a href=usecases.html>Use cases</a> |
    <a href=../userdoc.html>User</a> |
    <a href=../refman.html>Reference</a> |
    <a href=../pdfmanuals.html>Doc in pdf</a> |
    <a href=../publications.html>Publications</a>

  </div>

</div>

<!-- News : see news_*.rst pages -->

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="weighted-latin-square-problem">
<span id="tuto-wlsp"></span><h1>Weighted latin square problem<a class="headerlink" href="#weighted-latin-square-problem" title="Permalink to this heading"></a></h1>
<div align=right>
    <span style="color:Firebrick; font-weight:bold;"> Back to </span>
    <a href="tutorials.html">Tutorials</a> |
    <a href="usecases.html">Use cases</a>
</div><section id="brief-description">
<h2>Brief description<a class="headerlink" href="#brief-description" title="Permalink to this heading"></a></h2>
<p>The problem consists in assigning a value from 0 to N-1 to every cell of a NxN chessboard.
Each row and each column must be a permutation of N values. For each cell, a random cost in (1…N) is associated to every domain value.
The objective is to find a complete assignment where the sum of the costs associated to the selected values for the cells is minimized.</p>
</section>
<section id="cfn-model">
<h2>CFN model<a class="headerlink" href="#cfn-model" title="Permalink to this heading"></a></h2>
<p>We create NxN variables, one for every cell, with domain size N. An AllDifferent hard global constraint is used to model a permutation for every row and every column. Its encoding uses knapsack constraints.
Unary cost functions containing random costs associated to domain values are generated for every cell.
The worst possible solution is when every cell is associated with a cost of N, so the maximum cost of a solution is N**3, so forbidden assignments have cost k=N**3+1.</p>
</section>
<section id="example-for-n-4-in-json-cfn-format">
<h2>Example for N=4 in JSON .cfn format<a class="headerlink" href="#example-for-n-4-in-json-cfn-format" title="Permalink to this heading"></a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="n">problem</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;LatinSquare4&quot;</span><span class="p">,</span> <span class="s2">&quot;mustbe&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;65&quot;</span> <span class="p">},</span>
  <span class="n">variables</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;X0_0&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X0_1&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X0_2&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X0_3&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X1_0&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X1_1&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X1_2&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X1_3&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X2_0&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X2_1&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X2_2&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X2_3&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X3_0&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X3_1&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X3_2&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;X3_3&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
  <span class="n">functions</span><span class="p">:</span> <span class="p">{</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X0_0&quot;</span><span class="p">,</span> <span class="s2">&quot;X0_1&quot;</span><span class="p">,</span> <span class="s2">&quot;X0_2&quot;</span><span class="p">,</span> <span class="s2">&quot;X0_3&quot;</span><span class="p">],</span> <span class="s2">&quot;type:&quot;</span> <span class="n">salldiff</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;cost&quot;</span><span class="p">:</span> <span class="mi">65</span><span class="p">}},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X1_0&quot;</span><span class="p">,</span> <span class="s2">&quot;X1_1&quot;</span><span class="p">,</span> <span class="s2">&quot;X1_2&quot;</span><span class="p">,</span> <span class="s2">&quot;X1_3&quot;</span><span class="p">],</span> <span class="s2">&quot;type:&quot;</span> <span class="n">salldiff</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;cost&quot;</span><span class="p">:</span> <span class="mi">65</span><span class="p">}},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X2_0&quot;</span><span class="p">,</span> <span class="s2">&quot;X2_1&quot;</span><span class="p">,</span> <span class="s2">&quot;X2_2&quot;</span><span class="p">,</span> <span class="s2">&quot;X2_3&quot;</span><span class="p">],</span> <span class="s2">&quot;type:&quot;</span> <span class="n">salldiff</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;cost&quot;</span><span class="p">:</span> <span class="mi">65</span><span class="p">}},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X3_0&quot;</span><span class="p">,</span> <span class="s2">&quot;X3_1&quot;</span><span class="p">,</span> <span class="s2">&quot;X3_2&quot;</span><span class="p">,</span> <span class="s2">&quot;X3_3&quot;</span><span class="p">],</span> <span class="s2">&quot;type:&quot;</span> <span class="n">salldiff</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;cost&quot;</span><span class="p">:</span> <span class="mi">65</span><span class="p">}},</span>

    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X0_0&quot;</span><span class="p">,</span> <span class="s2">&quot;X1_0&quot;</span><span class="p">,</span> <span class="s2">&quot;X2_0&quot;</span><span class="p">,</span> <span class="s2">&quot;X3_0&quot;</span><span class="p">],</span> <span class="s2">&quot;type:&quot;</span> <span class="n">salldiff</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;cost&quot;</span><span class="p">:</span> <span class="mi">65</span><span class="p">}},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X0_1&quot;</span><span class="p">,</span> <span class="s2">&quot;X1_1&quot;</span><span class="p">,</span> <span class="s2">&quot;X2_1&quot;</span><span class="p">,</span> <span class="s2">&quot;X3_1&quot;</span><span class="p">],</span> <span class="s2">&quot;type:&quot;</span> <span class="n">salldiff</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;cost&quot;</span><span class="p">:</span> <span class="mi">65</span><span class="p">}},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X0_2&quot;</span><span class="p">,</span> <span class="s2">&quot;X1_2&quot;</span><span class="p">,</span> <span class="s2">&quot;X2_2&quot;</span><span class="p">,</span> <span class="s2">&quot;X3_2&quot;</span><span class="p">],</span> <span class="s2">&quot;type:&quot;</span> <span class="n">salldiff</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;cost&quot;</span><span class="p">:</span> <span class="mi">65</span><span class="p">}},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X0_3&quot;</span><span class="p">,</span> <span class="s2">&quot;X1_3&quot;</span><span class="p">,</span> <span class="s2">&quot;X2_3&quot;</span><span class="p">,</span> <span class="s2">&quot;X3_3&quot;</span><span class="p">],</span> <span class="s2">&quot;type:&quot;</span> <span class="n">salldiff</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;var&quot;</span><span class="p">,</span> <span class="s2">&quot;cost&quot;</span><span class="p">:</span> <span class="mi">65</span><span class="p">}},</span>

    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X0_0&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X0_1&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X0_2&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X0_3&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X1_0&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X1_1&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X1_2&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X1_3&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X2_0&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X2_1&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X2_2&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X2_3&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X3_0&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X3_1&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X3_2&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]},</span>
    <span class="p">{</span><span class="n">scope</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;X3_3&quot;</span><span class="p">],</span> <span class="s2">&quot;costs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]}}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Optimal solution with cost 35 for the latin 4-square example (in red, costs associated to the selected values) :</p>
<a class="reference internal image-reference" href="../_images/latin4.png"><img alt="../_images/latin4.png" src="../_images/latin4.png" style="height: 250px;" /></a>
</section>
<section id="python-model">
<h2>Python model<a class="headerlink" href="#python-model" title="Permalink to this heading"></a></h2>
<p>The following code using the pytoulbar2 library solves the weighted latin square problem with the first argument being the dimension N of the chessboard (e.g. “python3 latinsquare.py 6”).</p>
<p><a class="reference download internal" download="" href="../_downloads/c36465d2114180af465711c46372eca0/latinsquare.py"><code class="xref download docutils literal notranslate"><span class="pre">latinsquare.py</span></code></a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">seed</span><span class="p">,</span> <span class="n">randint</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">123456789</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">pytoulbar2</span>

<span class="n">N</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">top</span> <span class="o">=</span> <span class="n">N</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span><span class="mi">1</span>

<span class="n">Problem</span> <span class="o">=</span> <span class="n">pytoulbar2</span><span class="o">.</span><span class="n">CFN</span><span class="p">(</span><span class="n">top</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="c1">#Create a variable for each square</span>
        <span class="n">Problem</span><span class="o">.</span><span class="n">AddVariable</span><span class="p">(</span><span class="s1">&#39;Cell(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="c1">#Create a constraint all different with variables on the same row</span>
    <span class="n">Problem</span><span class="o">.</span><span class="n">AddAllDifferent</span><span class="p">([</span><span class="s1">&#39;Cell(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)],</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;salldiffkp&#39;</span><span class="p">)</span>

    <span class="c1">#Create a constraint all different with variables on the same column</span>
    <span class="n">Problem</span><span class="o">.</span><span class="n">AddAllDifferent</span><span class="p">([</span><span class="s1">&#39;Cell(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)],</span> <span class="n">encoding</span> <span class="o">=</span> <span class="s1">&#39;salldiffkp&#39;</span><span class="p">)</span>

<span class="c1">#Random unary costs</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">ListConstraintsUnaryC</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="n">ListConstraintsUnaryC</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="p">))</span>
        <span class="n">Problem</span><span class="o">.</span><span class="n">AddFunction</span><span class="p">([</span><span class="s1">&#39;Cell(&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">],</span> <span class="n">ListConstraintsUnaryC</span><span class="p">)</span>

<span class="c1">#Problem.Dump(&#39;WeightLatinSquare.cfn&#39;)</span>
<span class="n">Problem</span><span class="o">.</span><span class="n">CFN</span><span class="o">.</span><span class="n">timer</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">Problem</span><span class="o">.</span><span class="n">Solve</span><span class="p">(</span><span class="n">showSolutions</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
<span class="k">if</span> <span class="n">res</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">N</span><span class="o">*</span><span class="n">N</span><span class="p">:</span>
    <span class="c1"># pretty print solution</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">([</span><span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span> <span class="o">*</span> <span class="n">N</span> <span class="o">+</span> <span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">)])</span>
    <span class="c1"># and its cost</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Cost:&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, INRAE.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>